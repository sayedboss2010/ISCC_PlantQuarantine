
@model List<PlantQuar.DTO.DTO.ImPermissionsListDTO>

<script src="~/scripts/jquery.dataTables.min.js"></script>
<link href="~/assets/css/jquery.dataTables.min.css" rel="stylesheet" />

<link href="/Content/PagedList.css" rel="stylesheet" type="text/css" />
@{
    ViewBag.Title = "Stopping Permissions";
    Layout = "~/Views/Shared/_LayoutPage1.cshtml";
    var model = Model;
}

@section Title{
    <h2 class="ls-top-header">Stopping Permissions</h2>
}

@section Path{
    <li style="position: relative;right: 28px;">@PlantQuar.WEB.Language.Resource_data1.check</li>
    <li class="active" style="right: 43px; position: relative;">@PlantQuar.WEB.Language.Resource_data1.ImPermissionsList</li>
}

<style>
    th {
        font-size: 14px !important;
        text-align: center;
    }

    td {
        font-size: 16px !important;
        text-align: center;
        font-family: "Times New Roman", Times, serif !important;
    }

    .status {
        display: inline-block;
        margin: 20px 0px 20px 50px;
    }

    p {
        font-weight: bold;
    }

    #capq blockquote.styles {
        margin-bottom: 70px;
    }

    .btn-secondary {
        background-color: #1fb5ad;
    }

        .btn-secondary:not([disabled]):not(.disabled):active, .btn-secondary:not([disabled]):not(.disabled).active, .show > .btn-secondary.dropdown-toggle {
            color: #fff;
            background-color: #0c6265;
            border-color: #9ec7da;
            box-shadow: inset 0 3px 5px rgba(45, 101, 93, 0.125), 0 0 0 2px rgba(72, 145, 152, 0.5);
        }

        .btn-secondary:hover {
            background-color: #389da0;
            border-color: #7fc7d0;
        }

    .btn-group > .btn, .btn-group-vertical > .btn {
        width: 159px;
    }

    option:focus,
    option:hover {
        outline: none;
    }

    .label-primary {
        background-color: #6dcac2
    }

    option {
        color: #379598 !important;
    }

    .table-bordered tbody tr:nth-child(odd) td {
        background-color: #ececec;
    }

    .table-bordered tbody tr:nth-child(even) td {
        /*background-color: #31979a2e;*/
    }

    .table-bordered tbody tr.highlight td {
        background-color: #F2F5A9;
    }

    /*.table-bordered tbody tr:hover {
        background-color: #86d8e6;
        color: black;
        font-weight: bold;
    }*/

    .ch {
        list-style: none;
        margin: 0;
        padding: 0;
        overflow: auto;
        display: inline-block;
        bottom: 50px;
        position: relative;
    }

        .ch li {
            color: #545050;
            display: block;
            position: relative;
            float: right;
            /*width: 100%;*/
            height: 100px;
            /*border-bottom: 1px solid #333;*/
            /*display: inline-block*/
        }

            .ch li input[type=radio] {
                position: absolute;
                visibility: hidden;
            }

            .ch li label {
                display: block;
                position: relative;
                font-weight: 300;
                font-size: 15px;
                padding: 24px 36px 0px 55px;
                margin: 9px auto;
                height: 30px;
                z-index: 9;
                cursor: pointer;
                -webkit-transition: all 0.25s linear;
            }

            .ch li:hover label {
                color: #3da4a7;
            }

            .ch li .check {
                display: block;
                position: absolute;
                border: 5px solid #686664;
                border-radius: 100%;
                height: 25px;
                width: 25px;
                top: 30px;
                left: 20px;
                z-index: 5;
                transition: border .25s linear;
                -webkit-transition: border .25s linear;
            }

            .ch li:hover .check {
                border: 5px solid #3da4a7;
            }

            .ch li .check::before {
                display: block;
                position: absolute;
                content: '';
                border-radius: 100%;
                height: 10px;
                width: 9px;
                top: 2px;
                left: 3px;
                margin: auto;
                transition: background 0.25s linear;
                -webkit-transition: background 0.25s linear;
            }

    input[type=radio]:checked ~ .check {
        border: 5px solid #0c6265;
    }

        input[type=radio]:checked ~ .check::before {
            background: #0c6265;
        }

    input[type=radio]:checked ~ label {
        color: #0c6265;
    }

    .pagination > .active > a, .pagination > .active > span, .pagination > .active > a:hover, .pagination > .active > span:hover, .pagination > .active > a:focus, .pagination > .active > span:focus {
        z-index: 2;
        color: #ffffff;
        cursor: default;
        background-color: #257e80 !important;
        border-color: #1da8ab !important;
    }

    .pagination {
        right: 292px;
        position: relative;
    }

    select.form-control:not([size]):not([multiple]), #permisionnumber {
        height: 3.573rem;
        margin-top: 8px;
    }

    a {
        color: #0032e6;
        text-decoration: none;
    }

    .test {
        color: #a52525 !important;
    }

    #checkRequest_lst {
        display: block;
        overflow-x: auto;
        position: relative;
    }

    #btn_Approved {
        margin-bottom: 10px;
        width: 40%;
        float: left;
        color: white;
    }

    .table > thead > tr > th, .table > tbody > tr > th, .table > tfoot > tr > th, .table > thead > tr > td, .table > tbody > tr > td, .table > tfoot > tr > td {
        padding: 3px !important;
    }

    #Results, #ActivatePrint {
        height: 37px;
        width: 133px;
        background-color: #1e7c80;
        border: 2px solid #1e8084;
        box-shadow: 0 4px #1d9fa5;
        outline: none;
        color: white;
        float: left;
        margin-top: 25px;
        border-radius: 0px
    }

    #cbid1, #cbid2 {
        float: right;
        margin: 4px 4px;
    }
</style>
<div class="row">

    <div class="col-md-4 col-sm-12">
        <div>
            <p style="font-weight:bold">@PlantQuar.WEB.Language.Resource_data1.PermissionNumber</p>
        </div>
        <input type="text" placeholder="بحث برقم الإذن" id="permisionnumber" class="form-control" />
    </div>
    <div class="col-md-4 col-sm-12">
        <input type="submit" value='بحث' placeholder="search" id="Results" class="form-control" onclick="results()" />
    </div>
</div>
<br />
<div class="row">
    <div class="col-md-4">
        <div id="divid"> </div>
    </div>


</div>
<br />

<div class="tab-content tabs" id="PrintStatusID">
    <table id="Im_CountryConstrainTable" class="table table-bordered table-striped dataTable" role="grid" style="width:100%">
        <thead>
            <tr>
                <th style="font-weight:bold">@PlantQuar.WEB.Language.Resource_data1.ImPermissionNumber</th>
                <th style="font-weight:bold">@PlantQuar.WEB.Language.Resource_data1.ShortName_qualG</th>
                <th style="font-weight:bold">@PlantQuar.WEB.Language.Resource_data1.ImporterType</th>
                <th style="font-weight:bold">@PlantQuar.WEB.Language.Resource_data1.ImporterName2</th>
                <th style="font-weight:bold">@PlantQuar.WEB.Language.Resource_data1.ExportCountry</th>
                <th style="font-weight:bold">@PlantQuar.WEB.Language.Resource_data1.RequestDate</th>
                <th style="font-weight:bold">@PlantQuar.WEB.Language.Resource_data1.Details</th>
                <th>حالة الطلب</th>
                @*  <th >@PlantQuar.WEB.Language.Resource_data1.Print انجليزي</th>*@
            </tr>
        </thead>
        <tbody id="tblCheckLst">
            @*<tr>
                    <td id="ImPermissionNumberlbl"></td>
                    <td id="ShortName_qualGlbl"></td>
                    <td id="ImporterTypelbl"></td>
                    <td id="ImporterName2lbl"></td>
                    <td id="ExportCountrylbl"></td>

                    <td id="Detailslbl"></td>
                    <td id="IS_States"></td>

                </tr>*@

        </tbody>
    </table>
</div>


<div class="row">
    <div class="col-md-4">
        <div id="divid1"> </div>
    </div>
    <div class="col-md-4">
        <input type="button" id="ActivatePrint" onclick="update()" value="أيقاف الاذن" style="display:none" />
    </div>

</div>

<br />
<br />

<script>
    $(document).ready(function () {
        //  GetList();
        //  updateLable();
    });
   

    function GetList() {
        //   alert("ddd");
        var permisionnumber = $('#permisionnumber').val();
        var isAcceppted = 1;
       /* console.log(permisionnumber)*/

        if (permisionnumber.localeCompare("") != 0 ) {
            $.ajax(
                {
                    url: '/Im_Permissions/Stopping_Permission/GetPermissionsList?ImPermission_Number=' + permisionnumber
                        + '&Isacceppted=' + isAcceppted,
                    type: 'POST',
                    dataType: 'json',
                    success: function (data) {
                        var html = '';
                        var count = 0;
                        var x = '';

                       
                        if (data.Result != "ERROR") {
                            $.each(data, function (index, item) {

                              
                                if (item.IsAcceppted == true) {
                                    if (item.IsPaid == true) {

                                        if (item.IS_Print_Ar == true && item.IS_Print_EN == true) {
                                            x = "    <td> تم الموافقه وتم الدفع وتمت الطباعه</td>";
                                        }
                                        else {
                                            x = "<td>تمت الموافقه وتم الدفع ولم تتم الطباعة  </td>";
                                        }
                                    }
                                    else if (item.IsPaid == null) {
                                        x = "  <td> تمت الموافقه ولم يتم الدفع</td>";
                                    }
                                }
                                else if (item.IsAcceppted == false) {
                                    x = "  <td> تم رفض الطلب  </td>";
                                }
                                else {
                                    x = "       <td>  لم يتخذ اجراء علي الإذن  </td>";
                                }
                                html += "<tr><td>"
                                    + item.ImPermission_Number + "</td><td hidden>"
                                    + item.operationTypeName + "</td><td>"
                                    + item.shortName + "</td>"
                                html += " <td>"
                                    + item.ImporterTypeName + "</td><td>"
                                    + item.ImporterName + "</td><td>"
                                    + item.ExportCountryName + "</td><td> "
                                    +
                                    $.datepicker.formatDate('yy-mm-dd', (new Date(parseInt(item.Arrival_Date.substr(6))))) +
                                    "</td><td><a href='/Im_Permissions/Im_permissionDetail/Index?ImPermission_Number=" + item.ImPermission_Number + "'>@PlantQuar.WEB.Language.Resource_data1.Details</a></td>" + x;

                                if (item.Im_CheckRequest_ID == null) {

                                    document.getElementById("ActivatePrint").style.display = "block";

                                }
                                else {
                                    document.getElementById("ActivatePrint").style.display = "none";

                                    alertify.error("لا يمكنك العمل لأنه مستخدم");
                                }
                            })
                        }
                        else {
                            alertify.error("لا يوجد إذن بهذا الرقم");
                        }

                        $("#Im_CountryConstrainTable tbody").empty();
                        $("#Im_CountryConstrainTable tbody").append(html);
                       
                    }
                });
        }


    }
    function update() {


        activePrintDto = {}
        var permisionnumber = $('#permisionnumber').val();
        activePrintDto.Im_PermissionRequestID = permisionnumber;




        $.ajax(
            {
                url: '@Url.Action("UpdateUserDatal", "Stopping_Permission")',
                data: { activePrintDto: activePrintDto},
                type: 'POST',
                dataType: 'json',
                success: function (data) {
                    document.getElementById("ActivatePrint").style.display = "none";
                    alertify.success("تم ايقاف الاذن بنجاح")
                }
            });
    }
    function results() {
        GetList();
        // updateLable();

    }
    function updateLable() {
        var IS_Print_Ar = $("#cbid1").is(":checked");
        var IS_Print_EN = $("#cbid2").is(":checked");
        document.getElementById('labelPrintAr').innerHTML = IS_Print_Ar ? "لن يتم اعاده الطباعة مره اخري" : "سيتم اعاده الطباعة مره اخري";
        document.getElementById('labelPrintEn').innerHTML = IS_Print_EN ? "لن  يتم اعاده الطباعة مره اخري" : "سيتم اعاده الطباعة مره اخري";

    }
</script>
