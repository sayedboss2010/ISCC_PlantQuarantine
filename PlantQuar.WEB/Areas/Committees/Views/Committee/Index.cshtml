@using PlantQuar.DTO.DTO.Farm.FarmRequest

@{
    /**/

    ViewBag.Title = "Committee";
    Layout = "~/Views/Shared/_LayoutPage1.cshtml";
    var Dissablle = "";
    if (ViewBag.CommitteeTypeId == "2")
    {
        Dissablle = "disabled";
    }
    var reqCommiteeType = (farmCountryConstrainReturnDTO)ViewBag.reqCommiteeType;

}
@section Title{
    <h2 class="ls-top-header">لجنة الفحص</h2>
}
@section Path{
    <li style="position: relative;right: 28px;">فحص</li>
    <li class="active" style="right: 43px; position: relative;">@PlantQuar.WEB.Language.Resource_data1.ExportCommitte</li>
}
<link href="~/Content/jquery.timepicker.css" rel="stylesheet" />
<script src="~/scripts/jquery.timepicker.min.js"></script>
<style>
    #CommitteeType_ID {
        height: 3.573rem;
    }

    div.jtable-main-container > table.jtable > tbody > tr > td {
        font-size: 20px
    }

    .table-striped {
        font-size: 13px;
        font-weight: bold;
    }

    #ui-datepicker-div {
        z-index: 24 !important;
    }

    #Employee_AddEDIT {
        margin-bottom: 25px;
    }

    #submitValue, #search {
        background-color: #1e7c80 !important;
        border: 2px solid #1e8084 !important;
        box-shadow: 0 4px #1d9fa5 !important;
        outline: none;
        color: white;
        margin-top: 20px;
        width: 50%;
    }
</style>

@using (Html.BeginForm("CreateCommittee", "Committee", FormMethod.Post))
{

    <div class="form-box" id="lagnaDiv">

        <!--<div class="row" style="width:100%">
            <div class="col-md-4 col-sm-12">
                if (ViewBag.type == 1)
                {
                    <div class="col-md-12">
                        <label>PlantQuar.WEB.Language.Resource_data1.CommitteeType </label>-->
        @*@Html.DropDownList("CommitteeType_ID", "_")*@
        <!--<select id="CommitteeType_ID" Dissablle>

            if (ViewBag.CommitteeTypeId == "2")
            {
                <option value="2">PlantQuar.WEB.Language.Resource_data1.GeshneyCommittee</option>

            }
            else
            {
                if (ViewBag.CommitteeTypeId == "1")
                {
                    <option value="1" selected>PlantQuar.WEB.Language.Resource_data1.CheckCommittee</option>
                }
                else
                {
                    <option value="1">PlantQuar.WEB.Language.Resource_data1.CheckCommittee</option>
                }
                if (ViewBag.CommitteeTypeId == "3")
                {
                    <option value="3" selected>PlantQuar.WEB.Language.Resource_data1.CommitteeSampleData</option>
                }
                else
                {
                    <option value="3">PlantQuar.WEB.Language.Resource_data1.CommitteeSampleData</option>
                }
                if (ViewBag.CommitteeTypeId == "6")
                {
                    <option value="6" selected>PlantQuar.WEB.Language.Resource_data1.CommitteeTreatment</option>
                }
                else
                {
                    <option value="6">PlantQuar.WEB.Language.Resource_data1.CommitteeTreatment</option>
                }



            }-->
        @*@foreach (var cc in ViewBag.CommitteeTypee_ID)
            {
                if (ViewBag.CommitteeTypeId == 2)
                {
                    if (cc.Value == ViewBag.CommitteeTypeId)
                    {
                        <option value="@cc.Value" selected>@cc.DisplayText</option>
                    }
                    else
                    {
                        <option value="@cc.Value">@cc.DisplayText</option>
                    }
                }
                else
                {
                    if (cc.Value != 2)
                    {
                        if (cc.Value == ViewBag.CommitteeTypeId)
                        {
                            <option value="@cc.Value" selected>@cc.DisplayText</option>
                        }
                        else
                        {
                            <option value="@cc.Value">@cc.DisplayText</option>
                        }
                    }
                }


            }*@
        <!--</select>
            </div>
        }
        else
        {
            <div class="col-md-12">
                <label>PlantQuar.WEB.Language.Resource_data1.CommitteeType </label>


                <select id="CommitteeType_ID" disabled>

                    if (ViewBag.type == 2)
                    {
                        foreach (var cc in ViewBag.CommitteeTypee_ID)
                        {
                            <option value="cc.Value">cc.DisplayText</option>
                        }


                    }
                    else if (ViewBag.type == 3)
                    {

                        <option value="4">لجنة اعتماد محطة</option>


                    }

                </select>
            </div>

        }

        <div class="col-md-12">

            {
                if (ViewBag.type == 1)
                {
                    <label> PlantQuar.WEB.Language.Resource_data1.Date_of_registration_request  </label>
                    <input type="text" name="Check_Date" id="Check_Date" class="form-control" readonly value="@ViewBag.creationDate" />
                }
                else if (ViewBag.type == 2)
                {
                    <label> PlantQuar.WEB.Language.Resource_data1.FarmAccreditatRequestRegistrationDate  </label>
                    <input type="text" name="Check_Date" id="Check_Date" class="form-control" readonly value="@ViewBag.creationDate" />
                }
                else
                {
                    <label> PlantQuar.WEB.Language.Resource_data1.StationAccreditatRequestRegistrationDate  </label>
                    <input type="text" name="Check_Date" id="Check_Date" class="form-control" readonly value="@ViewBag.creationDate" />
                }
            }


        </div>-->
        @*<div class="col-md-12">
                <label>Day Type</label>
                <select id="daytype">


                    @foreach (var cc in ViewBag.ShiftTypes)
                    {
                        <option value="@cc.Value">@cc.DisplayText</option>
                    }


                </select>


            </div>*@

        <!--<div class="col-md-12">
            <label> PlantQuar.WEB.Language.Resource_data1.Time_of_ActionFrom</label>
            <input type="time" name="StartTime" id="StartTime" class="form-control" />
        </div>








        <div class="col-md-12">
            <label> PlantQuar.WEB.Language.Resource_data1.EmpolyeeName</label>-->
        @*<input type="text" name="Employee_name" id="Employee_name" class="form-control" />*@
        <!--<input type="text" id="Employee_name" placeholder="enter emp name" class="form-control" />
            </div>
        </div>
        <div class="col-md-4 col-sm-12">
            <div class="col-md-12">
                {
                    if (ViewBag.type == 1)
                    {
                        <label>PlantQuar.WEB.Language.Resource_data1.ExportRequestNumber</label>
                    }
                    else if (ViewBag.type == 2)
                    {
                        <label>PlantQuar.WEB.Language.Resource_data1.FarmNumber</label>
                    }
                    else
                    {
                        <label>PlantQuar.WEB.Language.Resource_data1.stationCode</label>
                    }
                }

                <input type="text" name="CheckRequest_Number" id="CheckRequest_Number" value="@ViewBag.data" class="form-control" readonly />

            </div>
            <div class="col-md-12">
                <label> PlantQuar.WEB.Language.Resource_data1.Date_of_committee</label>
                <input type="text" name="Delegation_Date" id="Delegation_Date" class="form-control" required />
            </div>-->
        @*<div class="col-md-12">
                <label></label>
                <select id="shifttiming" width="100%"></select>
            </div>*@
        <!--<div class="col-md-12">
                <label>  PlantQuar.WEB.Language.Resource_data1.To</label>
                <input type="time" name="EndTime" id="EndTime" class="form-control" />
            </div>
            <div class="col-md-12">
                <label>  PlantQuar.WEB.Language.Resource_data1.EmpolyeeNumber</label>
                <input type="text" name="Employee_No" id="Employee_No" class="form-control" />


            </div>
        </div>
        <div class="col-md-4 col-sm-12">
            <div class="col-md-12">-->
        @*<table class="table table-striped">
                <thead>
                    <tr>
                        <th scope="col">
                            @PlantQuar.WEB.Language.Resource_data1.EmpolyeeName
                        </th>
                        <th scope="col">
                            @PlantQuar.WEB.Language.Resource_data1.Admin
                        </th>
                    </tr>
                </thead>
                <tbody id="Employee_List"></tbody>
            </table>*@
        <!--<table id="Farm_Constrain_TextTable" class="table table-bordered table-striped dataTable" role="grid" style="padding:5px; width:100%">
                        <thead>
                            <tr>


                                <th>رقم الموظف </th>
                                <th>اسم الموظف </th>
                                <th>محافظة الموظف </th>
                                <th>منفذ الموظف </th>
                                <td hidden>ادمن</td>
                                <td>تسجيل</td>


                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                    <table id="myTable" border="1" name="gh">
                    </table>
                </div>

            </div>

        </div>
        <div class="row">
            <div class="" style="flex-direction: row; margin-right: auto!important;">-->
        @*<input type="button" class="btn btn-primary pull-right" style="margin-top:20px;" id="btn_Search" value="بحث بالموظف">*@
        <!--<input type="button" onclick="MyFunction()" value="بحث بالموظف" />
            </div>
            <input type="hidden" id="Committe_Id" value="@ViewBag.CommitteeId" />
            <input type="hidden" id="sId" value="@ViewBag.sId" />
            <input type="hidden" id="CheckRequest_Id" value="@ViewBag.checkRequestId" />
            <input type="hidden" id="CommitteeType_ID" value="@ViewBag.CommitteeTypeId" />
            <input type="hidden" id="farmReqId" value="@ViewBag.farmrequestId" />
            <input type="hidden" id="shiftId" />
        </div>
        <br />
        <div id="analysisType">
        </div>
        <br />-->
        @*<div id="Employee_AddEDIT">
            </div>*@
        <!--<br />
        <div id="ShiftsAddEdit">
        </div>-->







        <div class="tab" role="tabpanel" style="min-height:80% !important;">
            <ul class="row nav nav-tabs" role="tablist">
                <li role="presentation" class="active">
                    <a href="#ItemsTab" aria-controls="profile" role="tab" id="itemTab_il" data-toggle="tab">معلومات</a>
                </li>
                <li role="presentation">
                    <a href="#empploy" aria-controls="profile" role="tab" id="empploy_il" data-toggle="tab">اسم الموظف</a>
                </li>
                <li role="presentation">
                    <a href="#Anlysis" aria-controls="profile" role="tab" id="anlysis_il" data-toggle="tab">نوع التحليل</a>
                </li>
                <li role="presentation">
                    <a href="#QualGrpTab" aria-controls="profile" role="tab" id="qualGrp_il" data-toggle="tab">مواعيد النبواتجية</a>
                </li>
            </ul>
            <div class="tab-content tabs" style="background-color:whitesmoke  !important;">
                <div role="tabpanel" class="tab-pane fade in active" id="ItemsTab" style="height:220px;">

                    <div class="row">
                        <div class="col-md-4">
                            @if (ViewBag.type == 1)
                            {
                                <div class="">
                                    <label>@PlantQuar.WEB.Language.Resource_data1.CommitteeType </label>
                                    <select id="CommitteeType_ID" class="form-control" @Dissablle>

                                        @if (ViewBag.CommitteeTypeId == "2")
                                        {
                                            <option value="2">@PlantQuar.WEB.Language.Resource_data1.GeshneyCommittee</option>

                                        }
                                        else
                                        {
                                            if (ViewBag.CommitteeTypeId == "1")
                                            {
                                                <option value="1" selected>@PlantQuar.WEB.Language.Resource_data1.CheckCommittee</option>
                                            }
                                            else
                                            {
                                                <option value="1">@PlantQuar.WEB.Language.Resource_data1.CheckCommittee</option>
                                            }
                                            if (ViewBag.CommitteeTypeId == "3")
                                            {
                                                <option value="3" selected>@PlantQuar.WEB.Language.Resource_data1.CommitteeSampleData</option>
                                            }
                                            else
                                            {
                                                <option value="3">@PlantQuar.WEB.Language.Resource_data1.CommitteeSampleData</option>
                                            }
                                            if (ViewBag.CommitteeTypeId == "6")
                                            {
                                                <option value="6" selected>@PlantQuar.WEB.Language.Resource_data1.CommitteeTreatment</option>
                                            }
                                            else
                                            {
                                                <option value="6">@PlantQuar.WEB.Language.Resource_data1.CommitteeTreatment</option>
                                            }



                                        }

                                    </select>
                                </div>
                            }
                            else
                            {
                                <div class="">
                                    <label>@PlantQuar.WEB.Language.Resource_data1.CommitteeType </label>
                                    <select id="CommitteeType_ID" class="form-control" disabled>

                                        @if (ViewBag.type == 2)
                                        {
                                            foreach (var cc in ViewBag.CommitteeTypee_ID)
                                            {
                                                <option value="@cc.Value">@cc.DisplayText</option>
                                            }


                                        }
                                        else if (ViewBag.type == 3)
                                        {

                                            <option value="4">لجنة اعتماد محطة</option>


                                        }

                                    </select>
                                </div>

                            }
                        </div>
                        <div class="col-md-4">
                            <div class="">
                                @{
                                    if (ViewBag.type == 1)
                                    {
                                        <label>@PlantQuar.WEB.Language.Resource_data1.ExportRequestNumber</label>
                                    }
                                    else if (ViewBag.type == 2)
                                    {
                                        <label>@PlantQuar.WEB.Language.Resource_data1.FarmNumber</label>
                                    }
                                    else
                                    {
                                        <label>@PlantQuar.WEB.Language.Resource_data1.stationCode</label>
                                    }
                                }

                                <input type="text" name="CheckRequest_Number" id="CheckRequest_Number" value="@ViewBag.data" class="form-control" readonly />

                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">

                            @{
                                if (ViewBag.type == 1)
                                {
                                    <label> @PlantQuar.WEB.Language.Resource_data1.Date_of_registration_request  </label>
                                    <input type="text" name="Check_Date" id="Check_Date" class="form-control" readonly value="@ViewBag.creationDate" />
                                }
                                else if (ViewBag.type == 2)
                                {
                                    <label> @PlantQuar.WEB.Language.Resource_data1.FarmAccreditatRequestRegistrationDate  </label>
                                    <input type="text" name="Check_Date" id="Check_Date" class="form-control" readonly value="@ViewBag.creationDate" />
                                }
                                else
                                {
                                    <label> @PlantQuar.WEB.Language.Resource_data1.StationAccreditatRequestRegistrationDate  </label>
                                    <input type="text" name="Check_Date" id="Check_Date" class="form-control" readonly value="@ViewBag.creationDate" />
                                }
                            }


                        </div>
                        <div class="col-md-4">

                            <label> @PlantQuar.WEB.Language.Resource_data1.Date_of_committee</label>
                            <input type="text" name="Delegation_Date" id="Delegation_Date" class="form-control" required />

                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <label> @PlantQuar.WEB.Language.Resource_data1.Time_of_ActionFrom</label>
                            <input type="time" name="StartTime" id="StartTime" class="form-control" />
                        </div>
                        <div class="col-md-4">

                            <label>  @PlantQuar.WEB.Language.Resource_data1.To</label>
                            <input type="time" name="EndTime" id="EndTime" class="form-control" />

                        </div>
                    </div>
                </div>

                <div role="tabpanel" class="tab-pane fade" id="empploy" style="height:auto;">

                    <div class="row">
                        <div class="col-md-4">
                            <label> @PlantQuar.WEB.Language.Resource_data1.EmpolyeeName</label>
                            <input type="text" id="Employee_name" placeholder="enter emp name" class="form-control" />
                        </div>
                        <div class="col-md-4">
                            <label>  @PlantQuar.WEB.Language.Resource_data1.EmpolyeeNumber</label>
                            <input type="text" name="Employee_No" id="Employee_No" class="form-control" />
                        </div>
                        <div class="col-md-4" style="text-align:center">
                            <input type="button" id="search" onclick="MyFunction()" value="بحث بالموظف" />
                            <input type="hidden" id="Committe_Id" value="@ViewBag.CommitteeId" />
                            <input type="hidden" id="sId" value="@ViewBag.sId" />
                            <input type="hidden" id="CheckRequest_Id" value="@ViewBag.checkRequestId" />
                            <input type="hidden" id="CommitteeType_ID" value="@ViewBag.CommitteeTypeId" />
                            <input type="hidden" id="farmReqId" value="@ViewBag.farmrequestId" />
                            <input type="hidden" id="shiftId" />
                        </div>
                    </div>
                    <br />
                    <div class="row">
                        <table id="Farm_Constrain_TextTable" class="table table-bordered table-striped dataTable" role="grid" style="padding:5px; width:100%">
                            <thead>
                                <tr>
                                    <th>رقم الموظف </th>
                                    <th>اسم الموظف </th>
                                    <th>عنوان الموظف </th>
                                    <th> الاداره العامه للموظف </th>
                                    <th>منفذ الموظف </th>
                                    <th hidden>ادمن</th>
                                    <th>تسجيل</th>
                                </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>
                        <table id="myTable" border="1" name="gh" class="table table-bordered table-striped dataTable">
                            <thead>
                                <tr>
                                    <th>اسم المهندس </th>
                                    <th>كود المهندس </th>
                                    <th>ادمن</th>
                                    <th>حذف</th>

                                </tr>
                            </thead>
                            <tbody id="myTable2">
                            </tbody>
                        </table>

                    </div>
                    <br />

                </div>

                <div role="tabpanel" class="tab-pane fade" id="Anlysis" style="height:auto;">

                    <div class="row">
                        <div id="analysisType" style="width:100%">
                        </div>
                    </div>

                </div>
                <div role="tabpanel" class="tab-pane fade" id="QualGrpTab" style="height:auto;">

                    <div class="row">
                        <div id="ShiftsAddEdit" style="width:100%">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                        </div>
                        <div class="col-md-4">
                        </div>
                        <div class="col-md-4" style="text-align:center">
                            <input type="button" class="btn btn-primary" id="submitValue" value="@PlantQuar.WEB.Language.Resource_data1.Save">

                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>



    @section scripts{

        <script type="text/javascript">

     //   $('select[multiple]').multiselect();

    if ('@reqCommiteeType.countries.Count' > 0) {

        alert('@reqCommiteeType.constrainText');
        window.location = '/FA_Farm/FarmListOnLine/Index';
    }
    if ('@ViewBag.type' == 2) {
        $("#CommitteeType_ID").val('@reqCommiteeType.committeeTypeId');
        if ($("#CommitteeType_ID").val() == 5) {
                $("#analysisType").hide();
            }

            }


                           
             //************************SARA*********************//
            //ShiftsAddEdit
            $(function () {
                $('#ShiftsAddEdit').jtable({
                    title: '@PlantQuar.WEB.Language.Resource_data1.shiftTiming',
                    paging: true,
                    pageSize: 10,
                    sorting: true,
                    columnResizable: true,
                    columnSelectable: true,
                    saveUserPreferences: true,
                    actions: {
                        listAction: 'listshiftTiming',
                        createAction: 'CreateshiftTiming',
                        updateAction: 'UpdateshiftTiming',
                        deleteAction: 'DeleteshiftTiming',
                    },
                    fields: {
                        ID: {
                            key: true,
                            create: false,
                            edit: false,
                            list: false
                        },
                        Farm_Committee_ID: {
                    title: 'ssss',

                    display: function (data) {
                        //debugger;
                        //alert($("#Committe_Id").val())
                        return " <input type='text' value='" + $("#Committe_Id").val() + "' /> ";
                        },
                        list: false

                    },
                        ShiftTiming_ID: {
                            title: '@PlantQuar.WEB.Language.Resource_data1.shiftTiming',
                            inputClass: 'validate[required]',
                            options: function (data) {
                                return '../../Committees/Committee/getShiftTiming_Lst';
                            },
                        },
                        money: {
                            title: 'money',
                            inputClass: 'validate[notrequired]',
                            type: 'text',
                        },
                        Count: {
                            title: '@PlantQuar.WEB.Language.Resource_data1.DaysNumber',
                            inputClass: 'validate[required]',
                            type: 'text',
                        },
                    },
                    formCreated: function (event, data) {
                        console.log($("#Committe_Id").val())
                        $("#Edit-Farm_Committee_ID").val($("#Committe_Id").val());

                        $("#Edit-ShiftTiming_ID").change(function () {
                             $.ajax(
                {
                    url: '@Url.Action("getShiftTiming_Mony", "Committee", new { area = "Committees" })',
                                     type: 'Post',
                    //shiftId
                                     data: { shiftId: $(this).val() },
                    success: function (data) {
                        if (data.Options != null) {
                            $("#Edit-money").val(data.Options);
                        }

                    } //success
                 });//ajax
                        });
                        $('.jtable-input-field-container:nth-of-type(1)').hide();
                        $('#Edit-money').attr('readonly', 'readonly');
                        $('#Edit-Count').attr('type', 'number');

                        if (data.formType == "create") {
                            $(".ui-dialog-title").text("@PlantQuar.WEB.Language.Resource_data1.Add");
                        }
                        else {
                            $(".ui-dialog-title").text("@PlantQuar.WEB.Language.Resource_data1.Edit");
                        }
                    },
                    formSubmitting: function (event, data) {

                        return data.form.validationEngine('validate');
                    },
                    formClosed: function (event, data) {
                        data.form.validationEngine('hide');
                        data.form.validationEngine('detach');
                        $(".ui-dialog-title").text("@PlantQuar.WEB.Language.Resource_data1.Delete");
                    },
                    recordAdded: function (event, data) {
                        //Mah+Ag 17-4-2019 change display message
                        alertify.success("@PlantQuar.WEB.Language.Resource_data1.Save_Insert");
                    },
                    recordUpdated: function (event, data) {
                        //Mah+Ag 17-4-2019 change display message
                        alertify.success("@PlantQuar.WEB.Language.Resource_data1.Save_Update");
                    },
                    recordDeleted: function (event, data) {
                        //Mah+Ag 17-4-2019 change display message
                        alertify.success("@PlantQuar.WEB.Language.Resource_data1.Save_Delete");
                    },
                });
                $('#ShiftsAddEdit').jtable('load', { farmCommitteeId: '@ViewBag.CommitteeId' });

                $(".jtable-toolbar-item-add-record .jtable-toolbar-item-text").text("@PlantQuar.WEB.Language.Resource_data1.Add");
            });
        $(function () {
            $('#analysisType').jtable({
                title: '@PlantQuar.WEB.Language.Resource_data1.AnalysisType',
                paging: true,
                pageSize: 10,
                sorting: true,
                defaultSorting: 'Name_Ar DESC',
                columnResizable: true,
                columnSelectable: true,
                saveUserPreferences: true,
                actions: {
                    listAction: 'listfarmReqAnalysisType',
                    createAction: 'CreatefarmReqAnalysisType',
                    updateAction: 'UpdatefarmReqAnalysisType',
                    deleteAction: 'DeletefarmReqAnalysisType'
                },
                fields: {
                    ID: {
                        key: true,
                        create: false,
                        edit: false,
                        list: false
                    },
                    FarmCommittee_ID: {
                    title: 'ssss',
                    display: function (data) {
                        //debugger;
                        return " <input type='text' value='@ViewBag.CommitteeId' /> "
                        },
                        list: false
                    },
                    Farm_ItemCategories_ID: {
                    title: 'gg',
                    display: function (data) {
                        //debugger;
                        return " <input type='text' /> "
                        },
                        list: false
                                },
                                categoryName: {
                                    title: 'category Name',
                                    list: true,
                                    create: false,
                                    edit: false,
                                },
                    ListAnalysisType_Id: {
                        title: 'types',
                        inputClass: 'validate[required]',
                        options: function (data) {
                            return '/Committees/Committee/reqAnalysisType_List?requestId=' + $("#farmReqId").val();
                        },

                        list: true
                    },
                    AnalysisLabType_ID: {
                        title: 'types lab',
                        inputClass: 'validate[required]',
                        dependsOn: 'ListAnalysisType_Id',
                        options: function (data) {
                        return '/Committees/Committee/reqAnalysisLabType_List?analType=' + data.dependedValues.ListAnalysisType_Id;
                        },

                        list: true
                    },

                },
                                                formCreated: function (event, data) {
                                                    $('.jtable-input-field-container:nth-of-type(1)').hide();
                                                    $('.jtable-input-field-container:nth-of-type(2)').hide();
                    $("#Edit-FarmCommittee_ID").val('@ViewBag.CommitteeId');

                    if (data.formType == "create") {
                        $(".ui-dialog-title").text("@PlantQuar.WEB.Language.Resource_data1.Add");
                    }
                    else {
                       $(".ui-dialog-title").text("@PlantQuar.WEB.Language.Resource_data1.Edit");
                    }
                    $("#Edit-Name_Ar, #Edit-Name_En, #txt_AR_BTNSearch, #txt_EN_BTNSearch").attr('autocomplete', 'off');
                },
                formSubmitting: function (event, data) {

                    return data.form.validationEngine('validate');
                },
                formClosed: function (event, data) {
                    data.form.validationEngine('hide');
                    data.form.validationEngine('detach');
                    $(".ui-dialog-title").text("@PlantQuar.WEB.Language.Resource_data1.Delete");
                },
                 recordAdded: function (event, data) {
                    //Mah+Ag 17-4-2019 change display message
                    alertify.success("@PlantQuar.WEB.Language.Resource_data1.Save_Insert");
                },
                recordUpdated: function (event, data) {
                                        //Mah+Ag 17-4-2019 change display message
                    alertify.success("@PlantQuar.WEB.Language.Resource_data1.Save_Update");
                 },
                 recordDeleted: function (event, data) {
                                        //Mah+Ag 17-4-2019 change display message
                    alertify.success("@PlantQuar.WEB.Language.Resource_data1.Save_Delete");
                },
            });
            $('#analysisType').jtable('load', {
                farmCommitteeId: $('#Committe_Id').val(),
            });
        });
        </script>
        @*//nabila script*@
        <script>
            var list = [];
        function MyFunction() {
            $("#Farm_Constrain_TextTable tbody").empty();
            var EmplyeeName = document.getElementById("Employee_name").value;
            var Emplyee_No = $('#Employee_No').val();
            var EmplyeeNo;
           // alert(Emplyee_No)
            if (Emplyee_No === "") {
                 EmplyeeNo = 0;
            }
            else {
                 EmplyeeNo = parseInt($('#Employee_No').val());
            }
         //  alert(EmplyeeNo);
              $.ajax({
                        url: '@Url.Action("GetPR_User_Id", "Committee")',
                        type: "POST",
                  data: { FullName: EmplyeeName, EmplyeeNo: EmplyeeNo},
                  //  , Governorate=x.Governorate
                  //, Station=x.Station,
                  success: function (result) {
                      for (var i = 0; i < result.length; i++) {
                          alert(result.length);
                                var item = result[i];
                                carName = 1;
                                $("#Farm_Constrain_TextTable tbody").append("<tr>" +
                                    "<td>  " + item.EmpId + "  </td>"
                                    + "<td>" + item.DisplayText + "</td>" +
                                    "<td>  " + item.Adress + "المحافظه:" + item.Governorate + "القسم :" + item.Station+"" + "  </td>"
                                    + "<td>" + item.Email + "</td>"
                                    + "<td>" + item.JobTitleName + "</td>"
                                    //+'<td><input type="radio" id="chckBox_' + i + '" class="change-selector" value="' + result[i].Value + '" name="hello"   )"/></td>'
                                    + '<td><input type="checkbox" id="chckBox_' + i + '' + i + '" class="chckClass_' + i + '" value="' + result[i].Value + '" Name="' + result[i].DisplayText + '"  onchange="helloo(this)" " /></td>'
                                 // +  "<td>" + item.Value + "</td>" +
                                   + "</tr>");
                            }
                    },
                        error: function (xhr, status, error) {
                    }
              });
            let checkboxes = $("input[type='checkbox']");
            selectedCboxes = Array.prototype.slice.call(checkboxes).filter(ch => ch.checked == true);
            console.log(checkboxes);
        }

            function DeleteRow(element) {
                //alert(element.name);
                //console.log(element);
                var table = document.getElementById("myTable");

                var c = '#id' + element.name + '';
                $(c).remove();
            }
        function helloo(element) {
           // alert(element.value);


            if (element.checked) {
                //document.getElementById("myTable").insertRow(-1).innerHTML = '<td id=' + element.value + '>' + element.name
                //    + '</td><td>' + element.value + '</td>';



               //debugger;
                var table = document.getElementById("myTable2");

                var rowCount = table.rows.length;
                var row = table.insertRow(rowCount);
                row.id = 'id'+element.value;
                row.insertCell(0).innerHTML = element.name;
                row.insertCell(1).innerHTML = element.value;
                row.insertCell(2).innerHTML =
                    '<td><input type="radio" id="chckBox_' + element.value + '" class="change-selector" value="' + element.value + '" name="hello"   )"/></td>';
                row.insertCell(3).innerHTML =
                    '<td><a href="#" onclick="DeleteRow(this)" name="' + element.value + '">Delete</a></td>';
            }
            else {
                var c = '#id' + element.value + '';
                $(c).remove();

            }


            }




            function saveList() {
                var selectedOption = $("input:radio[name=hello]:checked").val()
                // alert("Your are a - " + selectedOption);
                if (typeof selectedOption !== "undefined")
                {

                    var rows = document.getElementById("myTable2").rows;
                    for (var i = 0, ceiling = rows.length; i < ceiling; i++) {
                        cells = rows[i].getElementsByTagName('td');
                        Employee_name = cells[0].innerHTML;
                        Employee_Id = cells[1].innerHTML;


                        var id = parseInt(Employee_Id);
                        if (id == selectedOption) {
                            ISAdmin = true;
                            //alert('d');
                            //console.log(selectedOption + ',,,,' + Employee_Id);
                        }
                        else {
                            ISAdmin = false;
                        }
                         //ISAdmin
                        //Employee_no
                        list.push({ Employee_name: Employee_name, Employee_Id: Employee_Id, ISAdmin: ISAdmin });

                    }
                    return list;
                }
                else {
                    return null;
                }

            }

        </script>

        <script type="text/javascript">
                $(document).ready(function () {
                    $("#CommitteeType_ID").attr("class", "form-control");
                 //   GetCheckRequest_Number_Data();
                })
        $(function () {
        @*$('#Employee_AddEDIT').jtable({
            title: '@PlantQuar.WEB.Language.Resource_data1.CommitteMember',
            paging: true,
            pageSize: 10,
            sorting: true,
            selecting: true, //Enable selecting
            multiselect: true, //Allow multiple selecting
            selectingCheckboxes: true, //Show checkboxes on first column
            columnResizable: true,
            columnSelectable: true,
            saveUserPreferences: true,
                actions: {
               //listAction: '/Committee/ListEmployee',
                    listAction: function (postData, jtParams) {
                        return $.Deferred(function ($dfd) {
                            $.ajax({
                                url: '/Committee/ListEmployee?Employee_name=' + $("#Employee_name").val() + '&Employee_No=' + $("#Employee_No").val() + '&jtStartIndex=' + jtParams.jtStartIndex + '&jtPageSize=' + jtParams.jtPageSize + '&jtSorting=' + jtParams.jtSorting,
                                type: 'POST',
                                dataType: 'json',
                                data: postData,
                                success: function (data) {
                                    if (data.Result == '-1') {

                                      //  $dfd.resolve(null);
                                    }
                                    else {
                                        $.each(data.Records, function (index, r) {
                                            var row = '<tr class="jtable-data-row jtable-row-even"><td class="jtable-selecting-column"><input type="checkbox"></td><td>' + r.DisplayText + '</td><td>' +  r.Value+ '</td></tr>';
                                            $("#Employee_AddEDIT->tbody").append(row);
                                        });
                                          $dfd.resolve(data);
                                        //remove dublication
                                    }
                                },
                                error: function () {
                                  //  $dfd.reject();
                                }
                            });
                        });
                    }
                },
            fields: {
                Value: {
                    key: true,
                    create: false,
                    edit: false,
                    list: false
                },
                Employee_name: {
                    title: ' @PlantQuar.WEB.Language.Resource_data1.Member',
                    inputClass: 'validate[required]',
                },
                Employee_Id: {
                    title: '@PlantQuar.WEB.Language.Resource_data1.MemberNumber',
                    inputClass: 'validate[required]',
                },
                ISAdmin: {
                    title: ' @PlantQuar.WEB.Language.Resource_data1.isadmin',

                    //inputClass: 'validate[required]',
                    //type: 'checkbox',
                    display: function (data) {
                        //debugger;
                        return " <input type='checkbox' id='isadmin_" + data.record.Employee_Id + "' /> "
                    }

                    },
            },
            formCreated: function (event, data) {

                if (data.formType == "create") {
                    $(".ui-dialog-title").text("@PlantQuar.WEB.Language.Resource_data1.Add");
                }
                else {
                    $(".ui-dialog-title").text("@PlantQuar.WEB.Language.Resource_data1.Edit");
                }
            },
            formSubmitting: function (event, data) {
                return data.form.validationEngine('validate');
            },
            formClosed: function (event, data) {
                data.form.validationEngine('hide');
                data.form.validationEngine('detach');
                $(".ui-dialog-title").text("@PlantQuar.WEB.Language.Resource_data1.Delete");
            },
             recordAdded: function (event, data) {
                    //Mah+Ag 17-4-2019 change display message
                    alertify.success("@PlantQuar.WEB.Language.Resource_data1.Save_Insert");
                },
                recordUpdated: function (event, data) {
                                        //Mah+Ag 17-4-2019 change display message
                    alertify.success("@PlantQuar.WEB.Language.Resource_data1.Save_Update");
                },
            recordDeleted: function (event, data) {
                                        //Mah+Ag 17-4-2019 change display message
                    alertify.success("@PlantQuar.WEB.Language.Resource_data1.Save_Delete");
                },
        });*@

        $(".jtable-toolbar-item-add-record .jtable-toolbar-item-text").text("@PlantQuar.WEB.Language.Resource_data1.Add");

        //Date&Time Form
        $("#Delegation_Date").datepicker(
            {
                dateFormat: 'yy-mm-dd',
                changeYear: true,
            }
        );
            //$('#StartTime,#EndTime').timepicker({
            //    timeFormat: 'HH:mm',
            //    interval: 60,
            //    minTime: '10',
            //    maxTime: '06:00pm',
            //    defaultTime: '11:00',
            //    startTime: '10:00',
            //    dynamic: false,
            //    dropdown: true,
            //    scrollbar: true,
            //    });
                });

        String.prototype.compose = (function () {
            var re = /\{{(.+?)\}}/g;
            return function (o) {
                return this.replace(re, function (_, k) {
                    return typeof o[k] != 'undefined' ? o[k] : '';
                });
            }
                }());

                $("#CommitteeType_ID").change(function () {
                    GetCheckRequest_Number_Data(true);
                });
        //CheckRequest_Number
                function GetCheckRequest_Number_Data(isChange=false) {
                    //debugger;

            CommitteeType_ID = $("#CommitteeType_ID").val()
                if ( CommitteeType_ID == "")
            {
                    alertify.error("يجب اختيار نوع اللجنة");
                return false;
            }
            $.ajax(
                {
                    url: "/Committee/GetCommittee",
                    type: "POST",
                    data: {
                        CheckRequest_Number: $("#CheckRequest_Number").val(),
                        CommitteeType_ID: CommitteeType_ID
                    },
                    success: function (res) {

                        //reset data
                        //   $("#CommitteeType_ID").val(null);
                        $("#Check_Date").val(null);
                        $("#Delegation_Date").val(null);
                        $("#StartTime").val(null);
                        $("#EndTime").val(null);
                        $("#Employee_AddEDIT").hide();
                        $("#CheckRequest_Id").val(0);
                        if (res.Result == 1) {
                            //set data found
                            var Request_committe = res.Request_committe;

                            if (Request_committe.Check_Date != null) {
                                $("#Check_Date").val($.datepicker.formatDate('yy-mm-dd', (new Date(parseInt(Request_committe.Check_Date.substr(6))))));
                            } if (Request_committe.Delegation_Date != null) {
                                $("#Delegation_Date").val($.datepicker.formatDate('yy-mm-dd', (new Date(parseInt(Request_committe.Delegation_Date.substr(6))))));
                            }$("#StartTime").val(Request_committe.StartTime);
                            $("#EndTime").val(Request_committe.EndTime);
                            $("#Employee_AddEDIT").show();
                            $("#submitValue").removeAttr("disabled");
                            //get check_request id
                            $("#CheckRequest_Id").val(Request_committe.CheckRequest_Id);
                            var Committe_Id = Request_committe.Committe_Id ;
                            $("#Committe_Id").val(Request_committe.Committe_Id);
                        if (Committe_Id == -1)
                            {
                            //no committe is found
                            }
                        else if (Committe_Id >0) {
                                    //there is a committe for the current request
                            //edit data and display employee data
                            var Employee_list = Request_committe.Employee_list;
                            //Value    Employee_name    Employee_Id

                            var tbody = $('#Employee_AddEDIT').children('tbody');
                            var table = tbody.length ? tbody : $('#Employee_AddEDIT').children('tbody');
                            //19-3-2020 fz clear table body
                                $('#Employee_List  tbody').empty();
                            $.each(Employee_list, function (index, r) {
                            //     var row = '<tr class="jtable-data-row jtable-row-even jtable-row-selected"><td class="jtable-selecting-column"><input type="checkbox" checked></td><td>' + r.Employee_name + '</td><td>' + r.Employee_Id + '</td></tr>';
                                var row = ' <tr class="jtable-data-row-selected"><td class="jtable-selecting-column"><input type="checkbox" checked></td><td>' + r.Employee_Id + '</td><td>' + r.Employee_name + '</td><td>' + r.Employee_Id + '</td></tr>';
                                $("#Employee_AddEDIT tbody").append(row);
                            });
                                }
                        }
                        else {

                            $("#submitValue").attr("disabled", true);
                            alertify.error("خطأ فى رقم طلب الفحص");
                        }
                    }
                });
        }
        //btn_Search
                var arrayRecords = new Array();
                var Admin_List = [];
                var admin_index = 0;
                var is_Admin = 0;
                @*$("#btn_Search").click(function () {

                    MyFunction();
                    ///////
                    Employee_name = $("#Employee_name").val();
                    Employee_No = $("#Employee_No").val();
                    if (Employee_name == "" && Employee_No == "") {
                        alert("يجب كتابة اسم او رقم الموظف");
                        return false;
                    }
                    var selectedRows = $('#Employee_AddEDIT').jtable('selectedRows');
                    if (selectedRows.length > 0) {

                        // build array of records
                        // arrayRecords = new Array();

                        selectedRows.each(function (index, element) {
                            arrayRecords[admin_index] = $(this).data('record');

                            var id = $(this).data('record').Employee_Id;
                            var valu = $("#isadmin_" + id).is(":checked");
                            var isAadmin = "";
                            if (valu == true) {
                                isAadmin = '@PlantQuar.WEB.Language.Resource_data1.Yes';
                            } else {
                                isAadmin = '@PlantQuar.WEB.Language.Resource_data1.No';
                            }
                            $("#Employee_List").append('<tr><td>' + $(this).data('record').Employee_name + '</td><td>' + isAadmin +'</td></tr>');
                            Admin_List[admin_index] = valu;
                            if (valu == true) {
                                is_Admin++;
                            }
                            admin_index++;
                        });
                    }
                    //debugger;
                    $('#Employee_AddEDIT').jtable('load', {

                        Employee_name: $("#Employee_name").val(),
                        Employee_No: $("#Employee_No").val(),
                    });
                    //arrayRecords  append

                    $.each(arrayRecords, function (index, r) {
                        //debugger;
                        var row = '<tr class="jtable-data-row jtable-row-even"><td class="jtable-selecting-column"><input type="checkbox" checked></td><td>' + r.Employee_name + '</td><td>' + r.Employee_Id + '</td><td></td></tr>';
                        $("#Employee_AddEDIT->tbody").append(row);
                    });
                });*@
/// ////////////////////////////////////////////Save
            $('#submitValue').click(function (e) {



                var employees = saveList();


                if (employees == null) {
                    alertify.error("يجب اختيار  ادمن ");
                    return false;
                }

                //console.log(employees);

            //  var rows = document.getElementById("myTable").rows;
            //for (var i = 0, ceiling = rows.length; i < ceiling; i++) {
            //    cells = rows[i].getElementsByTagName('td');
            //    Employee_name = cells[0].innerHTML;
            //    Employee_Id = cells[1].innerHTML;


            //            //<th hidden>EmployeeNo</th>
            //            //<th hidden>isAdmin</th>
            //    //ISAdmin
            //    //Employee_no
            //    list.push({ Employee_name: name,  Employee_Id: ids });
            //}
                /////////////////


                //19-3-2020 fz clear table body
                $('#Employee_List  tbody').empty();

                var CommitteeType_ID = $("#CommitteeType_ID").val();
                Delegation_Date = $("#Delegation_Date").val();
                StartTime = $("#StartTime").val();
                EndTime = $("#EndTime").val();

                if (Delegation_Date == ""
                        /*|| StartTime == "" || EndTime == ""*/) {
                    alertify.error("يجب استكمال البيانات ");
                    return false;
                }
           //   if (StartTime > EndTime) {

            //        alertify.error(" يجب ان يكون توقيت النهاية اكبر من توقيت البداية ");
              //      return false;
              //  }

                //#analysisType

                var rowCount = $('#analysisType table tr:not(.jtable-no-data-row)').length;
               // console.log(rowCount);
               // var analysisCount = $('#analysisType tbody').Count;


                //alert("analysisCount =========   " + analysisCount)

                // var analysis = saveAnalysis();
                var Type_Comm = $("#Committe_Id").val();
                if (Type_Comm == 12) {
                    if (rowCount == 1) {
                        alertify.error("يجب اختيار  نوع التحليل ");
                        return false;
                    }
                }


                       //debugger;
                        if ('@ViewBag.type' == 1) {
                            $.ajax({
                                type: "POST",
                                url: "/Committee/SaveCommitte_Employee",
                                dataType: "json",
                                //data: dataToSend,
                                data: JSON.stringify(
                                    {
                                        dataToSend: employees,
                                        //isAdmins: Admin_List,
                                        Committe_Id: $("#Committe_Id").val(),
                                        CheckRequest_Id: $("#CheckRequest_Id").val(),
                                        CommitteeType_ID: CommitteeType_ID,
                                        Check_Date: $("#Check_Date").val(),
                                        Delegation_Date: $("#Delegation_Date").val(),
                                        StartTime: $("#StartTime").val(),
                                        EndTime: $("#EndTime").val(),

                                    }),
                                contentType: "application/json; charset=utf-8",
                                success: function (data) {
                                    $("#Check_Date").val(null);
                                    $("#Delegation_Date").val(null);
                                    $("#StartTime").val(null);
                                    $("#EndTime").val(null);
                                    $("#Employee_AddEDIT").hide();
                                    $("#CheckRequest_Id").val(0);
                                    alertify.success("تم تشكيل اللجنة");
                                    window.location = '/ExportRequest/List_ExportRequests/Index';
                                }
                            });
                        }
                        else if ('@ViewBag.type' == 2) {

                            $.ajax({
                                type: "POST",
                                url: "/Committee/SavefarmCommitte_Employee",
                                dataType: "json",
                                data: JSON.stringify(
                                    {
                                        dataToSend: employees,
                                       // isAdmins: Admin_List,
                                        Committe_Id: $("#Committe_Id").val(),

                                        FarmId: $("#sId").val(),
                                        Delegation_Date: $("#Delegation_Date").val(),
                                        StartTime: $("#StartTime").val(),
                                        EndTime: $("#EndTime").val(),
                                        committeetype: $("#CommitteeType_ID").val(),
                                       // shiftId: $("#shiftId").val()
                                    }),
                                contentType: "application/json; charset=utf-8",
                                success: function (data) {

                                    $("#Delegation_Date").val(null);
                                    $("#StartTime").val(null);
                                    $("#EndTime").val(null);
                                    $("#Employee_AddEDIT").hide();

                                    alertify.success("تم تشكيل اللجنة");
                                  //  alert(StartTime);
                                    //alert(EndTime);
                                    window.location.href  = '../../FA_Farm/FarmListOnLine/Index';
                                }
                            });
                        }
                        else {
                            $.ajax({
                                type: "POST",
                                url: "/Committee/SaveStationCommitte_Employee",
                                dataType: "json",
                                data: JSON.stringify(
                                    {
                                        dataToSend: employees,
                                        Committe_Id: $("#Committe_Id").val(),
                                      //  isAdmins: Admin_List,
                                        stationAccrediationId: $("#sId").val(),
                                        Delegation_Date: $("#Delegation_Date").val(),
                                        StartTime: $("#StartTime").val(),
                                        EndTime: $("#EndTime").val()
                                    }),
                                contentType: "application/json; charset=utf-8",
                                success: function (data) {

                                    $("#Delegation_Date").val(null);
                                    $("#StartTime").val(null);
                                    $("#EndTime").val(null);
                                    $("#Employee_AddEDIT").hide();
                                    alertify.success.success("تم تشكيل اللجنة");
                                    window.location = '/Stations/StationAccrediationCommittee/Index';
                                }
                            });
                        }
            });
        </script>
    }
}