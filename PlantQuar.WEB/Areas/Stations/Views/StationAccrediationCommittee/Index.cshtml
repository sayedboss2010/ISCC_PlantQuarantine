
@{
    ViewBag.Title = "@PlantQuar.WEB.Language.Resource_data1.StationAccreditation";
    Layout = "~/Views/Shared/_LayoutPage1.cshtml";

}

@section Title{
    <h2 class="ls-top-header">@PlantQuar.WEB.Language.Resource_data1.StationAccreditation</h2>
}

@section Path{
    <li style="position: relative;right: 28px;">@PlantQuar.WEB.Language.Resource_data1.StationAccreditation</li>
    @*<li class="active" style="right: 43px; position: relative;">@PlantQuar.WEB.Language.Resource_data1.ExportRequestsList</li>*@
}

<style>
    th {
        font-size: 14px !important;
        text-align: center;
    }

    td {
        font-size: 12px !important;
        text-align: center;
    }

    .status {
        display: inline-block;
        margin: 20px 0px 20px 50px;
    }

    p {
        font-weight: bold;
    }

    #capq blockquote.styles {
        margin-bottom: 70px;
    }

    .btn-secondary {
        background-color: #1fb5ad;
    }

        .btn-secondary:not([disabled]):not(.disabled):active, .btn-secondary:not([disabled]):not(.disabled).active, .show > .btn-secondary.dropdown-toggle {
            color: #fff;
            background-color: #0c6265;
            border-color: #9ec7da;
            box-shadow: inset 0 3px 5px rgba(45, 101, 93, 0.125), 0 0 0 2px rgba(72, 145, 152, 0.5);
        }

        .btn-secondary:hover {
            background-color: #389da0;
            border-color: #7fc7d0;
        }

    .btn-group > .btn, .btn-group-vertical > .btn {
        width: 159px;
    }

    option:focus,
    option:hover {
        outline: none;
    }

    .label-primary {
        background-color: #3da4a7;
    }

    option {
        color: #379598 !important;
    }

    .table-bordered tbody tr:nth-child(odd) td {
        background-color: #42a9ad7a;
    }

    .table-bordered tbody tr:nth-child(even) td {
        background-color: #ceecf578;
    }

    .table-bordered tbody tr.highlight td {
        background-color: #F2F5A9;
    }

    .table-bordered tbody tr:hover {
        background-color: #86d8e6;
        color: black;
        font-weight: bold;
    }

    .ch {
        list-style: none;
        margin: 0;
        padding: 0;
        overflow: auto;
        display: inline-block;
        bottom: 50px;
        position: relative;
    }

        .ch li {
            color: #545050;
            display: block;
            position: relative;
            float: right;
            /*width: 100%;*/
            height: 100px;
            /*border-bottom: 1px solid #333;*/
            /*display: inline-block*/
        }

            .ch li input[type=radio] {
                position: absolute;
                visibility: hidden;
            }

            .ch li label {
                display: block;
                position: relative;
                font-weight: 300;
                font-size: 15px;
                padding: 24px 36px 0px 55px;
                margin: 9px auto;
                height: 30px;
                z-index: 9;
                cursor: pointer;
                -webkit-transition: all 0.25s linear;
            }

            .ch li:hover label {
                color: #3da4a7;
            }

            .ch li .check {
                display: block;
                position: absolute;
                border: 5px solid #686664;
                border-radius: 100%;
                height: 25px;
                width: 25px;
                top: 30px;
                left: 20px;
                z-index: 5;
                transition: border .25s linear;
                -webkit-transition: border .25s linear;
            }

            .ch li:hover .check {
                border: 5px solid #3da4a7;
            }

            .ch li .check::before {
                display: block;
                position: absolute;
                content: '';
                border-radius: 100%;
                height: 10px;
                width: 9px;
                top: 2px;
                left: 3px;
                margin: auto;
                transition: background 0.25s linear;
                -webkit-transition: background 0.25s linear;
            }

    input[type=radio]:checked ~ .check {
        border: 5px solid #0c6265;
    }

        input[type=radio]:checked ~ .check::before {
            background: #0c6265;
        }

    input[type=radio]:checked ~ label {
        color: #0c6265;
    }

    .pagination > .active > a, .pagination > .active > span, .pagination > .active > a:hover, .pagination > .active > span:hover, .pagination > .active > a:focus, .pagination > .active > span:focus {
        z-index: 2;
        color: #ffffff;
        cursor: default;
        background-color: #257e80 !important;
        border-color: #1da8ab !important;
    }

    .pagination {
        right: 292px;
        position: relative;
    }

    select.form-control:not([size]):not([multiple]) {
        height: 3.573rem;
        margin-top: 8px;
    }

    a {
        color: #0032e6;
        text-decoration: none;
    }

    .test {
        color: #a52525 !important;
    }

    #stationcode {
        width: 100%;
        height: 3.573rem;
        margin-top: 8px;
    }
</style>
<div style="bottom: 40px;position: relative;">
    <div class="col-md-4 col-sm-12">
        <div>
            <p style="font-weight:bold">@PlantQuar.WEB.Language.Resource_data1.CommitteeStatus </p>
        </div>

        <select id="selectApprove" class="form-control">
            <option value="choose">@PlantQuar.WEB.Language.Resource_data1.choose</option>
            <option id="rdoApprovedAll" value="-1">@PlantQuar.WEB.Language.Resource_data1.all</option>
            <option id="rdoApproved" value="1">@PlantQuar.WEB.Language.Resource_data1.Accept</option>
            <option id="rdoApprovedNot" value="0">@PlantQuar.WEB.Language.Resource_data1.notAccept</option>
            <option id="rdoApprovedNot2" value="-3">@PlantQuar.WEB.Language.Resource_data1.committeeNotFormed</option>
            <option id="rdoApprovedNot2" value="-2">@PlantQuar.WEB.Language.Resource_data1.committeeWorkNotEnd</option>
            <option id="rdoApprovedNot2" value="2">@PlantQuar.WEB.Language.Resource_data1.committeeWorkEnded</option>
        </select>
    </div>
    <div class="col-md-4 col-sm-12">
        <p style="font-weight:bold; margin-bottom:0px">@PlantQuar.WEB.Language.Resource_data1.stationCode</p>
        <input type="text" id="stationcode" class="form-control">

    </div>
    <div class="col-md-4 col-sm-12">
        <div>
            <p style="font-weight:bold">@PlantQuar.WEB.Language.Resource_data1.stationActivityType</p>
        </div>

        <select id="activityType" class="form-control">
            <option value="0">@PlantQuar.WEB.Language.Resource_data1.choose</option>
            @foreach (var type in ViewBag.StationActivityTypes)
            {
                <option value="@type.Value">@type.DisplayText</option>
            }
        </select>
    </div>
</div>
@*<input type="button" value="بحث"  id="btn_Approved"  name="btn_Approved" />*@
<div id="checkRequest_lst" class="table-responsive">
    <table class="table table-bordered" id="tblCheckLst">
        <thead>
            <tr class="label-primary">
                <th>م</th>
                <th>@PlantQuar.WEB.Language.Resource_data1.StationName</th>
                <th>@PlantQuar.WEB.Language.Resource_data1.ActivityType</th>
                <th>@PlantQuar.WEB.Language.Resource_data1.stationCode</th>
                <th>@PlantQuar.WEB.Language.Resource_data1.UserCreationDate</th>
                <th>@PlantQuar.WEB.Language.Resource_data1.DelegationDate</th>
                <th>@PlantQuar.WEB.Language.Resource_data1.Details </th>
                <th>@PlantQuar.WEB.Language.Resource_data1.CommitteeFormation</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
    <br />

</div>

<script>


    $(function () {


        $('#selectApprove').change(function () {

            btn_Approved_Click();
        });

        $('#stationcode').keyup(function () {

            btn_Approved_Click();
        });

        $('#activityType').change(function () {

            btn_Approved_Click();
        });

    });
    function btn_Approved_Click() {
        //debugger;
        var stationcode = $("#stationcode").val();
        if (stationcode == null || stationcode == "" || stationcode=='undefined' ) {
            stationcode = "";
        }

        var html = '';
        var j = 0;
        var Status = $("#selectApprove").val();
        var activityType = $("#activityType").val();
        if (Status != 'choose') {
            $.getJSON('/StationAccrediationCommittee/getStationCommitteeData', { stationcode: stationcode, Status: Status, stationActivityType: activityType}, function (data, succ) {
                console.log(data)
                $.each(data, function (i, item) {

                    stationId = item.stationId;
                    var Delegation_Date2 = "";
                    if (item.Delegation_Date == null) {
                        Delegation_Date2 = "--";

                    } else {
                        var Delegation_Date = new Date(item.Delegation_Date.match(/\d+/)[0] * 1);
                        Delegation_Date2 = Delegation_Date.getDate() + "/" + (Delegation_Date.getMonth() + 1) + "/" + Delegation_Date.getFullYear();
                    }
                    var User_Creation_Date = new Date(item.User_Creation_Date.match(/\d+/)[0] * 1);
                    var User_Creation_Date2 = User_Creation_Date.getDate() + "/" + (User_Creation_Date.getMonth() + 1) + "/" + User_Creation_Date.getFullYear();
                    j = i + 1;
                    html += "<tr id='stationId_" + stationId + "'><td>" + j + "</td><td>" + item.station_Name + "</td><td>" + item.StationActivity_Name + "</td><td>" + ((item.StationCode != null) ? item.StationCode:"-----") + "</td><td>" + Delegation_Date2  + "</td>";
                    html += "<td>" + User_Creation_Date2 + "</td><td><a href='/Stations/StationDetails/Index?StationAccrediationRequestId=" + item.stationAccCommitteeId + "' >@PlantQuar.WEB.Language.Resource_data1.Details</a>";
                     html += "</td>";

                    //IsApproved for station request and committe request
                    //Status for committee working
                    /*
                    start:      approve: state
                    New:        null:   null
                    approved:    1:   null
                    committee:   null:   0
                    */
                     if (item.IsPaid == true)
                     {
                         if (item.IsApproved == true && item.Status == null)
                         {
                                html += "<td><a href='/Committees/Committee/IndexStation?stationCommitteeId=" + item.stationAccCommitteeId + "'>@PlantQuar.WEB.Language.Resource_data1.CommitteeFormation </a></td>";
                             }
                                 if (item.Status == false &&item.IsApproved == null)
                                 {
                                        html += "<td>@PlantQuar.WEB.Language.Resource_data1.Waitingcustomerresponse</td>";
                                 }
                                 else if (item.Status == false &&item.IsApproved == true)
                                 {
                                        html += "<td>@PlantQuar.WEB.Language.Resource_data1.committeeapproved</td>";
                                 }
                                 else if (item.Status == false && item.IsApproved == true)
                                     {
                                        html += "<td>@PlantQuar.WEB.Language.Resource_data1.Reject</td>"
                                    }
  else if (item.Status == true && item.IsApproved == true)
                                     {
                                        html += "<td>@PlantQuar.WEB.Language.Resource_data1.committeeWorkEnded</td>"
                                    }
                         else if (item.IsApproved == false && item.Status == null)
                            {
                                html += "<td>@PlantQuar.WEB.Language.Resource_data1.requestrejected</td>"
                            }
                        else if (item.IsApproved == null && item.Status == null)
                             {
                            html += "<td>@PlantQuar.WEB.Language.Resource_data1.requestnotapproved</td>"
                            }

                     }//is paid
                     else {
                        html += "<td><a href='/Stations/StationPayment/Index?station_committee_Id=" + item.stationAccCommitteeId + "'>@PlantQuar.WEB.Language.Resource_data1.payMoney</a></td>";
                    }
                                         html += "</tr>";
                     @*if (item.IsPaid == true)
                     {
                         //for station request
                         if (item.IsApproved == true)
                         {
                             //committee
                             if (item.Status == null)
                             {
                                html += "<td><a href='/Committees/Committee/IndexStation?stationCommitteeId=" + item.stationAccCommitteeId + "'>@PlantQuar.WEB.Language.Resource_data1.CommitteeFormation </a></td>";
                            }//item.Status
                             else if (item.Status == false)
                             {
                               if (item.IsApproved == null)
                                 {
                                        html += "<td>@PlantQuar.WEB.Language.Resource_data1.Waitingcustomerresponse</td>";
                               }
                               else if (item.IsApproved == true)
                               {
                                        html += "<td>@PlantQuar.WEB.Language.Resource_data1.committeeapproved</td>";
                               }
                               else {
                                        html += "<td>@PlantQuar.WEB.Language.Resource_data1.Reject</td>"
                                    }
                            }
                                //status true
                                else {
                                }
                         }//IsApproved
                         else if (item.IsApproved == false)
                            {
                                html += "<td>@PlantQuar.WEB.Language.Resource_data1.requestrejected</td>"
                            }
                       else {
                                html += "<td>@PlantQuar.WEB.Language.Resource_data1.requestnotapproved</td>"
                            }

                     }//paid
                     else {
                        html += "<td><a href='/Stations/StationPayment/Index?station_committee_Id=" + item.stationAccCommitteeId + "'>@PlantQuar.WEB.Language.Resource_data1.payMoney</a></td>";
                    }*@
                                         html += "</tr>";
                });
                $("#tblCheckLst tbody").empty();
                $("#tblCheckLst tbody").append(html);
            });

        }


    }

</script>