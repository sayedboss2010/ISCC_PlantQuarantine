

@model List<PlantQuar.DTO.DTO.Im_CheckRequest_General.General_ImCheckRequestListDTO>

@*@using PagedList.Mvc;*@

<link href="/Content/PagedList.css" rel="stylesheet" type="text/css" />
<style>
    .bootstrap-select .dropdown-menu.inner {
        margin-right: 0px !important;
    }
</style>
<link href="~/assets/css/bootstrap-select.min.css" rel="stylesheet" />

<style>
    th {
        font-size: 14px !important;
        text-align: center;
    }

    td {
        font-size: 16px !important;
        text-align: center;
        font-family: "Times New Roman", Times, serif !important;
    }

    .status {
        display: inline-block;
        margin: 20px 0px 20px 50px;
    }

    p {
        font-weight: bold;
    }

    #capq blockquote.styles {
        margin-bottom: 70px;
    }

    .btn-secondary {
        background-color: #1fb5ad;
    }

        .btn-secondary:not([disabled]):not(.disabled):active, .btn-secondary:not([disabled]):not(.disabled).active, .show > .btn-secondary.dropdown-toggle {
            color: #fff;
            background-color: #0c6265;
            border-color: #9ec7da;
            box-shadow: inset 0 3px 5px rgba(45, 101, 93, 0.125), 0 0 0 2px rgba(72, 145, 152, 0.5);
        }

        .btn-secondary:hover {
            background-color: #389da0;
            border-color: #7fc7d0;
        }

    .btn-group > .btn, .btn-group-vertical > .btn {
        width: 159px;
    }

    option:focus,
    option:hover {
        outline: none;
    }

    option {
        color: #379598 !important;
    }

    .table-bordered tbody tr:nth-child(odd) td {
        background-color: #ececec;
    }

    .table-bordered tbody tr:nth-child(even) td {
        /*background-color: #31979a2e;*/
    }

    .table-bordered tbody tr.highlight td {
        background-color: #F2F5A9;
    }

    /*.table-bordered tbody tr:hover {
            background-color: #86d8e6;
            color: black;
            font-weight: bold;
        }*/

    .ch {
        list-style: none;
        margin: 0;
        padding: 0;
        overflow: auto;
        display: inline-block;
        bottom: 50px;
        position: relative;
    }

        .ch li {
            color: #545050;
            display: block;
            position: relative;
            float: right;
            /*width: 100%;*/
            height: 100px;
            /*border-bottom: 1px solid #333;*/
            /*display: inline-block*/
        }

            .ch li input[type=radio] {
                position: absolute;
                visibility: hidden;
            }

            .ch li label {
                display: block;
                position: relative;
                font-weight: 300;
                font-size: 15px;
                padding: 24px 36px 0px 55px;
                margin: 9px auto;
                height: 30px;
                z-index: 9;
                cursor: pointer;
                -webkit-transition: all 0.25s linear;
            }

            .ch li:hover label {
                color: #3da4a7;
            }

            .ch li .check {
                display: block;
                position: absolute;
                border: 5px solid #686664;
                border-radius: 100%;
                height: 25px;
                width: 25px;
                top: 30px;
                left: 20px;
                z-index: 5;
                transition: border .25s linear;
                -webkit-transition: border .25s linear;
            }

            .ch li:hover .check {
                border: 5px solid #3da4a7;
            }

            .ch li .check::before {
                display: block;
                position: absolute;
                content: '';
                border-radius: 100%;
                height: 10px;
                width: 9px;
                top: 2px;
                left: 3px;
                margin: auto;
                transition: background 0.25s linear;
                -webkit-transition: background 0.25s linear;
            }

    input[type=radio]:checked ~ .check {
        border: 5px solid #0c6265;
    }

        input[type=radio]:checked ~ .check::before {
            background: #0c6265;
        }

    input[type=radio]:checked ~ label {
        color: #0c6265;
    }

    .pagination > .active > a, .pagination > .active > span, .pagination > .active > a:hover, .pagination > .active > span:hover, .pagination > .active > a:focus, .pagination > .active > span:focus {
        z-index: 2;
        color: #ffffff;
        cursor: default;
        background-color: #257e80 !important;
        border-color: #1da8ab !important;
    }

    .pagination {
        right: 292px;
        position: relative;
    }

    select.form-control:not([size]):not([multiple]) {
        height: 3.573rem;
    }

    a {
        color: #0032e6;
        text-decoration: none;
    }

    .test {
        color: #a52525 !important;
    }

    .table-bordered > thead > tr > th, .table-bordered > tbody > tr > th, .table-bordered > tfoot > tr > th, .table-bordered > thead > tr > td, .table-bordered > tbody > tr > td, .table-bordered > tfoot > tr > td {
        border: 1px solid black !important;
        padding: 5px;
    }

    #checkRequest_lst {
        display: block;
        overflow-x: auto;
        position: relative;
    }

    #btn_Approved {
        margin-bottom: 10px;
        width: 40%;
        float: left;
        color: white;
    }

    .form-control {
        height: 3.573rem !important;
        margin-top: 8px !important;
        padding: 5px;
    }

    #Results {
        height: 37px !important;
        width: 133px;
        background-color: #1e7c80;
        border: 2px solid #1e8084;
        box-shadow: 0 4px #1d9fa5;
        outline: none;
        color: white;
        float: left;
        margin-top: 25px !important;
        border-radius: 0px;
    }

    table, table td, table th {
        border: 1px solid black !important;
        border-collapse: collapse !important;
        word-break: break-word !important;
    }
</style>
<style>
    th {
        font-size: 14px !important;
        text-align: center;
    }

    td {
        font-size: 16px !important;
        text-align: center;
        font-family: "Times New Roman", Times, serif !important;
    }

    .status {
        display: inline-block;
        margin: 20px 0px 20px 50px;
    }

    p {
        font-weight: bold;
    }

    #capq blockquote.styles {
        margin-bottom: 70px;
    }

    .btn-secondary {
        background-color: #1fb5ad;
    }

        .btn-secondary:not([disabled]):not(.disabled):active, .btn-secondary:not([disabled]):not(.disabled).active, .show > .btn-secondary.dropdown-toggle {
            color: #fff;
            background-color: #0c6265;
            border-color: #9ec7da;
            box-shadow: inset 0 3px 5px rgba(45, 101, 93, 0.125), 0 0 0 2px rgba(72, 145, 152, 0.5);
        }

        .btn-secondary:hover {
            background-color: #389da0;
            border-color: #7fc7d0;
        }

    .btn-group > .btn, .btn-group-vertical > .btn {
        width: 159px;
    }

    option:focus,
    option:hover {
        outline: none;
    }

    .label-primary {
        background-color: #6dcac2
    }

    option {
        color: #379598 !important;
    }

    .table-bordered tbody tr:nth-child(odd) td {
        background-color: #ececec;
    }

    .table-bordered tbody tr:nth-child(even) td {
        /*background-color: #31979a2e;*/
    }

    .table-bordered tbody tr.highlight td {
        background-color: #F2F5A9;
    }

    /*.table-bordered tbody tr:hover {
            background-color: #86d8e6;
            color: black;
            font-weight: bold;
        }*/

    .ch {
        list-style: none;
        margin: 0;
        padding: 0;
        overflow: auto;
        display: inline-block;
        bottom: 50px;
        position: relative;
    }

        .ch li {
            color: #545050;
            display: block;
            position: relative;
            float: right;
            /*width: 100%;*/
            height: 100px;
            /*border-bottom: 1px solid #333;*/
            /*display: inline-block*/
        }

            .ch li input[type=radio] {
                position: absolute;
                visibility: hidden;
            }

            .ch li label {
                display: block;
                position: relative;
                font-weight: 300;
                font-size: 15px;
                padding: 24px 36px 0px 55px;
                margin: 9px auto;
                height: 30px;
                z-index: 9;
                cursor: pointer;
                -webkit-transition: all 0.25s linear;
            }

            .ch li:hover label {
                color: #3da4a7;
            }

            .ch li .check {
                display: block;
                position: absolute;
                border: 5px solid #686664;
                border-radius: 100%;
                height: 25px;
                width: 25px;
                top: 30px;
                left: 20px;
                z-index: 5;
                transition: border .25s linear;
                -webkit-transition: border .25s linear;
            }

            .ch li:hover .check {
                border: 5px solid #3da4a7;
            }

            .ch li .check::before {
                display: block;
                position: absolute;
                content: '';
                border-radius: 100%;
                height: 10px;
                width: 9px;
                top: 2px;
                left: 3px;
                margin: auto;
                transition: background 0.25s linear;
                -webkit-transition: background 0.25s linear;
            }

    input[type=radio]:checked ~ .check {
        border: 5px solid #0c6265;
    }

        input[type=radio]:checked ~ .check::before {
            background: #0c6265;
        }

    input[type=radio]:checked ~ label {
        color: #0c6265;
    }

    .pagination > .active > a, .pagination > .active > span, .pagination > .active > a:hover, .pagination > .active > span:hover, .pagination > .active > a:focus, .pagination > .active > span:focus {
        z-index: 2;
        color: #ffffff;
        cursor: default;
        background-color: #257e80 !important;
        border-color: #1da8ab !important;
    }

    .pagination {
        right: 292px;
        position: relative;
    }

    select.form-control:not([size]):not([multiple]), #permisionnumber {
        height: 3.573rem;
        margin-top: 8px;
    }

    a {
        color: #0032e6;
        text-decoration: none;
    }

    .test {
        color: #a52525 !important;
    }

    .table-bordered > thead > tr > th, .table-bordered > tbody > tr > th, .table-bordered > tfoot > tr > th, .table-bordered > thead > tr > td, .table-bordered > tbody > tr > td, .table-bordered > tfoot > tr > td {
        border: 2px solid #000 !important;
    }

    #checkRequest_lst {
        display: block;
        overflow-x: auto;
        position: relative;
    }

    #btn_Approved {
        margin-bottom: 10px;
        width: 40%;
        float: left;
        color: white;
    }

    .table > thead > tr > th, .table > tbody > tr > th, .table > tfoot > tr > th, .table > thead > tr > td, .table > tbody > tr > td, .table > tfoot > tr > td {
        padding: 3px !important;
    }

    #Results {
        height: 37px;
        width: 133px;
        background-color: #1e7c80;
        border: 2px solid #1e8084;
        box-shadow: 0 4px #1d9fa5;
        outline: none;
        color: white;
        float: left;
        margin-top: 25px;
        border-radius: 0px
    }
</style>
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_LayoutPage1.cshtml";
    var model = Model;
}
@section Title{
    <h2 class="ls-top-header">طلبات فحص الترانزيت</h2>
}
<div class="row mar-bottom-15">
    <div class="col-md-6 flex-align" id="Start_Date">
        <label class="col-md-4" style="margin-top:10px">بداية البحث</label>
        <input class="form-control col-md-8" id="dateFrom" name="date" value="@ViewBag.DateFrom.Date.ToString("yyyy-MM-dd")" placeholder="DD/MM/YYY" type="date" />
    </div>
    <div class="col-md-6 flex-align" id="End_Date">
        <label class="col-md-4" style="margin-top:10px">نهاية البحث</label>
        <input class="form-control col-md-8" id="dateEnd" name="date" placeholder="DD/MM/YYY" value="@ViewBag.DateTo.Date.ToString("yyyy-MM-dd")" type="date" />
        <input id="HDN_Im_OpertaionType_ID" name="HDN_Im_OpertaionType_ID" value="@ViewBag.Im_OpertaionType_ID" type="hidden" />
    </div>


    <div class="col-md-6 flex-align" id="Div_selectApprove">
        <label class="col-md-4" style="margin-top:10px">موقف الطلب </label>
        <select id="selectApprove" class="form-control col-md-8  selectApprove">
            <option id="rdoApprovedAll" value="choose">@PlantQuar.WEB.Language.Resource_data1.choose</option>
            <option id="rdoApprovedAll" value="1">@PlantQuar.WEB.Language.Resource_data1.chooseall</option>
            <option id="rdoAcceptedAll" value="5">الطلبات الموافقه عليه</option>
            <option id="rdoRefusedAll" value="2">لم يتم الموافقة</option>
            <option id="rdoNothingAll" value="3">لم يتم اتخاذ اجراء</option>
            <option id="rdoClosedAll" value="4">الطلب مغلق</option>
            <option id="FinalResult_worked" name="الطلب يعمل" value="6">موقف الحجر الطلب يعمل</option>
            <option id="FinalResult_notworked" name="الطلب لا يعمل" value="7">موقف الحجر الطلب لا يعمل</option>
        </select>
    </div>

    <div class="col-md-6 flex-align" id="Div_FinalResultList">
        <label class="col-md-4" style="margin-top:10px">موقف الحجر  </label>
        <select id="FinalResultList" name="FinalResultList" class="form-control col-md-8  FinalResultList"></select>
    </div>

    <div class="col-md-6 flex-align" id="Div_CheckRequest_Number">
        <label class="col-md-4" style="margin-top:10px">رقم الطلب </label>
        <input class="form-control col-md-8" id="Txt_CheckRequest_Number" name="date" type="text" />
    </div>
    <div class="col-md-6 flex-align" id="Div_CheckRequest_Number">
        <label class="col-md-4" style="margin-top:10px">اسم الشركة</label>
        <select id="Company_List" class="form-control col-md-8  Company_List"></select>
    </div>
</div>

<div class="row mar-bottom-15">

    <input type="hidden" id="Hid_Outlet_ID" name="name" value="@ViewBag.Outlet_ID" />
    <input type="hidden" id="Hid_message" name="name" value="@ViewBag.message" />
    <div class="col-md-4 col-sm-12">
        <input type="button" value='@PlantQuar.WEB.Language.Resource_data1.Search' placeholder="search" id="btn_Approved" class="form-control" />
    </div>


</div>
<script>
    //const urlSearchParams = new URLSearchParams(window.location.search);
    //const params = Object.fromEntries(urlSearchParams.entries());
    //var Outlet_ID = params.Outlet_ID;
    //alert(Outlet_ID)

    var _message = $('#Hid_message').val();
    if (_message != "") {
        if (_message != null) {
            alert(_message);
        }
    }

    var _Outlet_ID = $('#Hid_Outlet_ID').val();

              $.ajax(
                  {

                url: '@Url.Action("Company_List", "List_ImCheckRequest", new { area = "Im_CheckRequests" })',
                      type: 'Post',
                      data: { Outlet_ID: _Outlet_ID},
                success: function (data) {
                    $('#Company_List').empty();
                    $.each(data.Options, function (i, index) {
                        $('#Company_List').append($('<option />').val(index.Value).text(index.DisplayText));
                    }); //each

                } //success
            });//ajax
    $('#btn_Approved').click(function () {




        var selectApproveId = $("#selectApprove Option:selected").val();
        var select_FinalResultList_Text = $("#FinalResultList Option:selected").text();
        if (selectApproveId > 0) {
            // alert();
            var FinalResultListId = "";
            if ($("#FinalResultList Option:selected").val() == 0) {

                FinalResultListId = 0;
            }
            else {
                FinalResultListId = $("#FinalResultList Option:selected").val();
            }
            var DateFrom = $('#dateFrom').val();
            var DateEnd = $('#dateEnd').val();
            var CheckRequest_Number = $('#Txt_CheckRequest_Number').val();
            var _Company_ID = $("#Company_List Option:selected").val();
            var _Im_OpertaionType_ID = $("#HDN_Im_OpertaionType_ID").val();

            window.open("/Im_CheckRequest_General/General_List_ImCheckRequest/General_Im_CheckRequest_List?DateFrom=" + DateFrom
                + "&DateEnd=" +DateEnd
                + "&selectApproveId=" + selectApproveId
                + "&FinalResultListId=" + FinalResultListId
                + "&CheckRequest_Number=" + CheckRequest_Number
                + "&Company_ID=" + _Company_ID
                + "&Im_OpertaionType_ID=" + _Im_OpertaionType_ID
            );
            @*$.ajax(
                {
                    url: '@Url.Action("Im_CheckRequest_List", "List_ImCheckRequest", new { area = "Im_CheckRequests" })',
                    type: 'Post',
                    data: {
                        DateFrom: DateFrom, DateEnd: DateEnd, selectApproveId: selectApproveId, FinalResultListId: FinalResultListId
                        , CheckRequest_Number:CheckRequest_Number,Company_ID: _Company_ID},
                    success: function (data) {
                        alert(data);
                        if (data !="") {
                            window.location.href = '/Im_CheckRequests/List_ImCheckRequest/Im_CheckRequest_List?DateFrom=' + DateFrom
                                + '&DateEnd=' + DateEnd
                                + '&selectApproveId=' + selectApproveId
                                + '&FinalResultListId=' + FinalResultListId
                                + '&CheckRequest_Number=' + CheckRequest_Number
                                + '&Company_ID=' + _Company_ID;
                        }
                        else {
                            alert("البيانات غير موجوده");
                        }

                    } //success
                });//ajax*@

        }
        else {
            alert("يجب اختيار  موقف الطلب");
        }
    });
    $('#selectApprove').on("change", function () {
        $("#FinalResultList").empty();

        var FinalResult = document.getElementById("selectApprove").value;

        if (FinalResult == 6 || FinalResult == 7) {

            $.ajax(
                {
                    url: '@Url.Action("FinalResult_AddEDIT", "Im_FinalResult_Data", new { area = "DE_Import" })',
                    type: 'Post',
                    data: { FinalResult: $('#selectApprove').val() },
                    success: function (data) {
                        $('#FinalResultList').empty();

                        $('#FinalResultList').append($('<option />').val(0).text("اختار"));
                        $.each(data.Options, function (i, index) {
                            $('#FinalResultList').append($('<option />').val(index.Value).text(index.DisplayText));
                        }); //each
                    } //success
                });//ajax
        }
    });


        //$(" #Company_List").selectpicker({
        //    liveSearch: true
        //});

        //App.init();


    //const urlSearchParams = new URLSearchParams(window.location.search);
    //const params = Object.fromEntries(urlSearchParams.entries());
    //var CheckRequest = params.CheckRequest;

</script>
